<!DOCTYPE html>
<html>
<head>
  <style>
    .error {
        color: red;
    }
  </style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega@5"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-lite@4.17.0"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-embed@6"></script>
</head>
<body>
  <div id="vis"></div>
  <script>
    (function(vegaEmbed) {
      var spec = {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300, "strokeWidth": 0}, "legend": {"labelColor": "rgb(102, 111, 137)", "labelFont": "Roboto, Arial, sans-serif", "labelFontSize": 12, "rowPadding": 4, "symbolSize": 40, "titleBaseline": "top", "titleColor": "rgb(25, 39, 78)", "titleFont": "Roboto, Arial, sans-serif", "titleFontSize": 12, "titleFontWeight": "bold", "titlePadding": 8}}, "vconcat": [{"hconcat": [{"vconcat": [{"mark": {"type": "text", "align": "center", "baseline": "middle", "color": "rgb(25, 39, 78)", "font": "Roboto, Arial, sans-serif", "fontWeight": "bold", "size": 14}, "encoding": {"text": {"value": ""}}, "height": 45.0, "width": 32.0}, {"layer": [{"mark": {"type": "text", "align": "center", "baseline": "middle", "color": "rgb(25, 39, 78)", "font": "Roboto, Arial, sans-serif", "fontWeight": "bold", "size": 14}, "encoding": {"text": {"value": "FPR"}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "y_position", "scale": {"domain": [3, 1]}, "type": "quantitative"}}, "transform": [{"calculate": "1.2", "as": "y_position"}]}, {"mark": {"type": "text", "align": "center", "baseline": "middle", "color": "rgb(102, 111, 137)", "font": "Roboto, Arial, sans-serif", "size": 12}, "encoding": {"text": {"value": "Groups"}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "y_position", "scale": {"domain": [3, 1]}, "type": "quantitative"}}, "transform": [{"calculate": "2", "as": "y_position"}]}, {"mark": {"type": "text", "align": "center", "baseline": "middle", "color": "rgb(102, 111, 137)", "font": "Roboto, Arial, sans-serif", "size": 12}, "encoding": {"text": {"value": "% Pop."}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "y_position", "scale": {"domain": [3, 1]}, "type": "quantitative"}}, "transform": [{"calculate": "2.7", "as": "y_position"}]}], "height": 65.0, "width": 32.0}, {"layer": [{"mark": {"type": "text", "align": "center", "baseline": "middle", "color": "rgb(25, 39, 78)", "font": "Roboto, Arial, sans-serif", "fontWeight": "bold", "size": 14}, "encoding": {"text": {"value": "FDR"}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "y_position", "scale": {"domain": [3, 1]}, "type": "quantitative"}}, "transform": [{"calculate": "1.2", "as": "y_position"}]}, {"mark": {"type": "text", "align": "center", "baseline": "middle", "color": "rgb(102, 111, 137)", "font": "Roboto, Arial, sans-serif", "size": 12}, "encoding": {"text": {"value": "Groups"}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "y_position", "scale": {"domain": [3, 1]}, "type": "quantitative"}}, "transform": [{"calculate": "2", "as": "y_position"}]}, {"mark": {"type": "text", "align": "center", "baseline": "middle", "color": "rgb(102, 111, 137)", "font": "Roboto, Arial, sans-serif", "size": 12}, "encoding": {"text": {"value": "% Pop."}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "y_position", "scale": {"domain": [3, 1]}, "type": "quantitative"}}, "transform": [{"calculate": "2.7", "as": "y_position"}]}], "height": 65.0, "width": 32.0}, {"layer": [{"mark": {"type": "text", "align": "center", "baseline": "middle", "color": "rgb(25, 39, 78)", "font": "Roboto, Arial, sans-serif", "fontWeight": "bold", "size": 14}, "encoding": {"text": {"value": "PPREV"}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "y_position", "scale": {"domain": [3, 1]}, "type": "quantitative"}}, "transform": [{"calculate": "1.2", "as": "y_position"}]}, {"mark": {"type": "text", "align": "center", "baseline": "middle", "color": "rgb(102, 111, 137)", "font": "Roboto, Arial, sans-serif", "size": 12}, "encoding": {"text": {"value": "Groups"}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "y_position", "scale": {"domain": [3, 1]}, "type": "quantitative"}}, "transform": [{"calculate": "2", "as": "y_position"}]}, {"mark": {"type": "text", "align": "center", "baseline": "middle", "color": "rgb(102, 111, 137)", "font": "Roboto, Arial, sans-serif", "size": 12}, "encoding": {"text": {"value": "% Pop."}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "y_position", "scale": {"domain": [3, 1]}, "type": "quantitative"}}, "transform": [{"calculate": "2.7", "as": "y_position"}]}], "height": 65.0, "width": 32.0}], "bounds": "flush", "data": {"name": "data-79dd248bdaa0ea02c535240e8ad022c8"}, "spacing": 20.0}, {"hconcat": [{"vconcat": [{"data": {"name": "data-79dd248bdaa0ea02c535240e8ad022c8"}, "mark": {"type": "text", "align": "center", "baseline": "middle", "color": "rgb(25, 39, 78)", "font": "Roboto, Arial, sans-serif", "fontWeight": "bold", "size": 14}, "encoding": {"text": {"value": "Sex_Cat"}}, "height": 45.0, "width": 240.0}, {"layer": [{"data": {"name": "data-0648884f34076ca4404072fa7f837079"}, "mark": {"type": "text", "align": "center", "baseline": "middle", "font": "Roboto, Arial, sans-serif", "fontWeight": "bold", "size": 20}, "encoding": {"color": {"field": "parity_result", "legend": {"offset": 0, "padding": 20, "title": "Parity Test"}, "scale": {"domain": ["Reference", "Pass", "Fail"], "range": ["rgb(102, 111, 137)", "rgb(0, 163, 158)", "rgb(211, 47, 47)"]}, "type": "ordinal"}, "text": {"value": "FAIL"}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "y_position", "scale": {"domain": [3, 1]}, "type": "quantitative"}}, "transform": [{"calculate": "1", "as": "y_position"}]}, {"data": {"name": "data-17fb7689948422ff9042c144eba445de"}, "mark": {"type": "bar", "size": 6, "stroke": "white"}, "encoding": {"color": {"field": "fpr_parity_result", "legend": null, "scale": {"domain": ["Reference", "Pass", "Fail"], "range": ["rgb(102, 111, 137)", "rgb(0, 163, 158)", "rgb(211, 47, 47)"]}, "type": "ordinal"}, "tooltip": [{"field": "fpr_parity_result", "title": "Parity", "type": "nominal"}, {"field": "tooltip_group_size", "title": "Size", "type": "nominal"}, {"field": "tooltip_groups_name_size", "title": "Groups", "type": "nominal"}], "x": {"aggregate": "sum", "axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "group_size", "stack": "normalize", "type": "quantitative"}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "y_position", "scale": {"domain": [3, 1]}, "type": "quantitative"}}, "transform": [{"calculate": "2.8", "as": "y_position"}]}, {"data": {"name": "data-0763a30168c135d8b66f76f7bba9b96e"}, "mark": {"type": "circle", "opacity": 1}, "encoding": {"color": {"field": "fpr_parity_result", "legend": null, "scale": {"domain": ["Reference", "Pass", "Fail"], "range": ["rgb(102, 111, 137)", "rgb(0, 163, 158)", "rgb(211, 47, 47)"]}, "type": "ordinal"}, "size": {"value": 300}, "tooltip": [{"field": "attribute_value", "title": "Group", "type": "nominal"}, {"field": "tooltip_group_size", "title": "Group Size", "type": "nominal"}, {"field": "tooltip_parity_test_explanation_fpr", "title": "Parity Test", "type": "nominal"}, {"field": "tooltip_disparity_explanation_fpr", "title": "Disparity", "type": "nominal"}, {"field": "fpr", "format": ".2f", "title": "FPR", "type": "quantitative"}], "x": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "fpr_disparity_rank", "scale": {"domain": [-2, 2], "nice": false}, "type": "quantitative"}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "y_position", "scale": {"domain": [3, 1]}, "type": "quantitative"}}, "transform": [{"calculate": "2", "as": "y_position"}]}], "height": 65.0, "resolve": {"scale": {"x": "independent"}}, "width": 240.0}, {"layer": [{"data": {"name": "data-126d4ae515fac080ab56453e43289c66"}, "mark": {"type": "text", "align": "center", "baseline": "middle", "font": "Roboto, Arial, sans-serif", "fontWeight": "bold", "size": 20}, "encoding": {"color": {"field": "parity_result", "legend": {"offset": 0, "padding": 20, "title": "Parity Test"}, "scale": {"domain": ["Reference", "Pass", "Fail"], "range": ["rgb(102, 111, 137)", "rgb(0, 163, 158)", "rgb(211, 47, 47)"]}, "type": "ordinal"}, "text": {"value": "PASS"}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "y_position", "scale": {"domain": [3, 1]}, "type": "quantitative"}}, "transform": [{"calculate": "1", "as": "y_position"}]}, {"data": {"name": "data-f3e433267fd29c12bb9976b0cd1170e1"}, "mark": {"type": "bar", "size": 6, "stroke": "white"}, "encoding": {"color": {"field": "fdr_parity_result", "legend": null, "scale": {"domain": ["Reference", "Pass", "Fail"], "range": ["rgb(102, 111, 137)", "rgb(0, 163, 158)", "rgb(211, 47, 47)"]}, "type": "ordinal"}, "tooltip": [{"field": "fdr_parity_result", "title": "Parity", "type": "nominal"}, {"field": "tooltip_group_size", "title": "Size", "type": "nominal"}, {"field": "tooltip_groups_name_size", "title": "Groups", "type": "nominal"}], "x": {"aggregate": "sum", "axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "group_size", "stack": "normalize", "type": "quantitative"}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "y_position", "scale": {"domain": [3, 1]}, "type": "quantitative"}}, "transform": [{"calculate": "2.8", "as": "y_position"}]}, {"data": {"name": "data-0763a30168c135d8b66f76f7bba9b96e"}, "mark": {"type": "circle", "opacity": 1}, "encoding": {"color": {"field": "fdr_parity_result", "legend": null, "scale": {"domain": ["Reference", "Pass", "Fail"], "range": ["rgb(102, 111, 137)", "rgb(0, 163, 158)", "rgb(211, 47, 47)"]}, "type": "ordinal"}, "size": {"value": 300}, "tooltip": [{"field": "attribute_value", "title": "Group", "type": "nominal"}, {"field": "tooltip_group_size", "title": "Group Size", "type": "nominal"}, {"field": "tooltip_parity_test_explanation_fdr", "title": "Parity Test", "type": "nominal"}, {"field": "tooltip_disparity_explanation_fdr", "title": "Disparity", "type": "nominal"}, {"field": "fdr", "format": ".2f", "title": "FDR", "type": "quantitative"}], "x": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "fdr_disparity_rank", "scale": {"domain": [-2, 2], "nice": false}, "type": "quantitative"}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "y_position", "scale": {"domain": [3, 1]}, "type": "quantitative"}}, "transform": [{"calculate": "2", "as": "y_position"}]}], "height": 65.0, "resolve": {"scale": {"x": "independent"}}, "width": 240.0}, {"layer": [{"data": {"name": "data-0648884f34076ca4404072fa7f837079"}, "mark": {"type": "text", "align": "center", "baseline": "middle", "font": "Roboto, Arial, sans-serif", "fontWeight": "bold", "size": 20}, "encoding": {"color": {"field": "parity_result", "legend": {"offset": 0, "padding": 20, "title": "Parity Test"}, "scale": {"domain": ["Reference", "Pass", "Fail"], "range": ["rgb(102, 111, 137)", "rgb(0, 163, 158)", "rgb(211, 47, 47)"]}, "type": "ordinal"}, "text": {"value": "FAIL"}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "y_position", "scale": {"domain": [3, 1]}, "type": "quantitative"}}, "transform": [{"calculate": "1", "as": "y_position"}]}, {"data": {"name": "data-41d2f801658fca22aa00cf5e0dd2d216"}, "mark": {"type": "bar", "size": 6, "stroke": "white"}, "encoding": {"color": {"field": "pprev_parity_result", "legend": null, "scale": {"domain": ["Reference", "Pass", "Fail"], "range": ["rgb(102, 111, 137)", "rgb(0, 163, 158)", "rgb(211, 47, 47)"]}, "type": "ordinal"}, "tooltip": [{"field": "pprev_parity_result", "title": "Parity", "type": "nominal"}, {"field": "tooltip_group_size", "title": "Size", "type": "nominal"}, {"field": "tooltip_groups_name_size", "title": "Groups", "type": "nominal"}], "x": {"aggregate": "sum", "axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "group_size", "stack": "normalize", "type": "quantitative"}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "y_position", "scale": {"domain": [3, 1]}, "type": "quantitative"}}, "transform": [{"calculate": "2.8", "as": "y_position"}]}, {"data": {"name": "data-0763a30168c135d8b66f76f7bba9b96e"}, "mark": {"type": "circle", "opacity": 1}, "encoding": {"color": {"field": "pprev_parity_result", "legend": null, "scale": {"domain": ["Reference", "Pass", "Fail"], "range": ["rgb(102, 111, 137)", "rgb(0, 163, 158)", "rgb(211, 47, 47)"]}, "type": "ordinal"}, "size": {"value": 300}, "tooltip": [{"field": "attribute_value", "title": "Group", "type": "nominal"}, {"field": "tooltip_group_size", "title": "Group Size", "type": "nominal"}, {"field": "tooltip_parity_test_explanation_pprev", "title": "Parity Test", "type": "nominal"}, {"field": "tooltip_disparity_explanation_pprev", "title": "Disparity", "type": "nominal"}, {"field": "pprev", "format": ".2f", "title": "PPREV", "type": "quantitative"}], "x": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "pprev_disparity_rank", "scale": {"domain": [-2, 2], "nice": false}, "type": "quantitative"}, "y": {"axis": {"domain": false, "grid": false, "labels": false, "ticks": false, "title": null}, "field": "y_position", "scale": {"domain": [3, 1]}, "type": "quantitative"}}, "transform": [{"calculate": "2", "as": "y_position"}]}], "height": 65.0, "resolve": {"scale": {"x": "independent"}}, "width": 240.0}], "bounds": "flush", "spacing": 20.0}], "bounds": "flush", "spacing": 288.0}], "bounds": "flush", "spacing": 80.0}, {"layer": [{"mark": {"type": "text", "align": "left", "baseline": "top", "fill": "rgb(102, 111, 137)", "font": "Roboto, Arial, sans-serif", "fontSize": 12, "fontWeight": "normal"}, "encoding": {"text": {"value": "For a group to pass the parity test its disparity to the reference group cannot exceed the fairness threshold (1.25)."}, "x": {"value": 24.0}, "y": {"value": 0}}}, {"mark": {"type": "text", "align": "left", "baseline": "top", "fill": "rgb(102, 111, 137)", "font": "Roboto, Arial, sans-serif", "fontSize": 12, "fontWeight": "normal"}, "encoding": {"text": {"value": "An attribute passes the parity test for a given metric if all its groups pass the test."}, "x": {"value": 24.0}, "y": {"value": 15.0}}}], "data": {"name": "data-79dd248bdaa0ea02c535240e8ad022c8"}}], "padding": 15, "usermeta": {"embedOptions": {"scaleFactor": 5, "downloadFileName": "summary_chart"}}, "$schema": "https://vega.github.io/schema/vega-lite/v4.17.0.json", "datasets": {"data-79dd248bdaa0ea02c535240e8ad022c8": [{"a": 1, "b": 0}, {"a": 1, "b": 0}], "data-0648884f34076ca4404072fa7f837079": [{"parity_result": "Fail"}], "data-17fb7689948422ff9042c144eba445de": [{"fpr_parity_result": "Fail", "attribute_name": "sex_cat", "total_entities": 238, "group_size": 109, "tooltip_groups_name_size": "Female (109)", "tooltip_group_size": "109 (45.80%)"}, {"fpr_parity_result": "Reference", "attribute_name": "sex_cat", "total_entities": 238, "group_size": 129, "tooltip_groups_name_size": "Male (129)", "tooltip_group_size": "129 (54.20%)"}], "data-0763a30168c135d8b66f76f7bba9b96e": [{"attribute_name": "sex_cat", "attribute_value": "Female", "group_size": 109, "total_entities": 238, "ref_group_value": "Male", "fpr": 0.019230769230769232, "fdr": 0.4, "pprev": 0.045871559633027525, "fpr_disparity": 0.3621794871794872, "fdr_disparity": 0.9333333333333335, "pprev_disparity": 0.4226736566186108, "fpr_disparity_scaled": -1.7610619469026547, "fpr_parity_result": "Fail", "tooltip_parity_test_explanation_fpr": "Fail. Above fairness threshold of 1.25", "tooltip_disparity_explanation_fpr": "2.76 times smaller FPR than the reference group", "tooltip_group_size": "109 (45.80%)", "fpr_disparity_rank": -1.0, "group_size_formatted": "109", "tooltip_groups_name_size": "Female (109)", "fdr_disparity_scaled": -0.07142857142857117, "fdr_parity_result": "Pass", "tooltip_parity_test_explanation_fdr": "Pass. Below fairness threshold of 1.25", "tooltip_disparity_explanation_fdr": "1.07 times smaller FDR than the reference group", "fdr_disparity_rank": -1.0, "pprev_disparity_scaled": -1.365891472868217, "pprev_parity_result": "Fail", "tooltip_parity_test_explanation_pprev": "Fail. Above fairness threshold of 1.25", "tooltip_disparity_explanation_pprev": "2.37 times smaller PPREV than the reference group", "pprev_disparity_rank": -1.0}, {"attribute_name": "sex_cat", "attribute_value": "Male", "group_size": 129, "total_entities": 238, "ref_group_value": "Male", "fpr": 0.05309734513274336, "fdr": 0.42857142857142855, "pprev": 0.10852713178294573, "fpr_disparity": 1.0, "fdr_disparity": 1.0, "pprev_disparity": 1.0, "fpr_disparity_scaled": 0.0, "fpr_parity_result": "Reference", "tooltip_parity_test_explanation_fpr": "Reference group", "tooltip_disparity_explanation_fpr": "Reference group", "tooltip_group_size": "129 (54.20%)", "fpr_disparity_rank": 0.0, "group_size_formatted": "129", "tooltip_groups_name_size": "Male (129)", "fdr_disparity_scaled": 0.0, "fdr_parity_result": "Reference", "tooltip_parity_test_explanation_fdr": "Reference group", "tooltip_disparity_explanation_fdr": "Reference group", "fdr_disparity_rank": 0.0, "pprev_disparity_scaled": 0.0, "pprev_parity_result": "Reference", "tooltip_parity_test_explanation_pprev": "Reference group", "tooltip_disparity_explanation_pprev": "Reference group", "pprev_disparity_rank": 0.0}], "data-126d4ae515fac080ab56453e43289c66": [{"parity_result": "Pass"}], "data-f3e433267fd29c12bb9976b0cd1170e1": [{"fdr_parity_result": "Pass", "attribute_name": "sex_cat", "total_entities": 238, "group_size": 109, "tooltip_groups_name_size": "Female (109)", "tooltip_group_size": "109 (45.80%)"}, {"fdr_parity_result": "Reference", "attribute_name": "sex_cat", "total_entities": 238, "group_size": 129, "tooltip_groups_name_size": "Male (129)", "tooltip_group_size": "129 (54.20%)"}], "data-41d2f801658fca22aa00cf5e0dd2d216": [{"pprev_parity_result": "Fail", "attribute_name": "sex_cat", "total_entities": 238, "group_size": 109, "tooltip_groups_name_size": "Female (109)", "tooltip_group_size": "109 (45.80%)"}, {"pprev_parity_result": "Reference", "attribute_name": "sex_cat", "total_entities": 238, "group_size": 129, "tooltip_groups_name_size": "Male (129)", "tooltip_group_size": "129 (54.20%)"}]}};
      var embedOpt = {"mode": "vega-lite"};

      function showError(el, error){
          el.innerHTML = ('<div class="error" style="color:red;">'
                          + '<p>JavaScript Error: ' + error.message + '</p>'
                          + "<p>This usually means there's a typo in your chart specification. "
                          + "See the javascript console for the full traceback.</p>"
                          + '</div>');
          throw error;
      }
      const el = document.getElementById('vis');
      vegaEmbed("#vis", spec, embedOpt)
        .catch(error => showError(el, error));
    })(vegaEmbed);

  </script>
</body>
</html>